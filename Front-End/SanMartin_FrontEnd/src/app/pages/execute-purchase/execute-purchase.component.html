<div class="container">
  <h1>Detalles de la Compra</h1>

  <section class="order-summary">
    <h2>Resumen de tu Pedido</h2>
    <div class="order-summary-header">
      <p>Producto</p>
      <p>Precio</p>
      <p>Cantidad</p>
      <p>Subtotal</p>
    </div>

    <div *ngFor="let item of cartLinesOrder" class="order-summary-item">
      <p>{{ item.product.name }}</p>
      <p>{{ item.product.priceUni }}</p>
      <p>{{ item.quantity }}</p>
      <p>{{ item.product.priceUni * item.quantity }}</p>
    </div>

    <div class="order-total">
      <p><strong>Total: </strong>{{ order.totalAmount }}</p>
    </div>
  </section>

  <!-- Solo dirección + botón MP -->
  <form class="form" [formGroup]="shippingForm" (ngSubmit)="pagarConMercadoPago()">
    <div class="form-group">
      <label for="address">Dirección</label>

      <ng-container *ngIf="addresses && addresses.length > 0; else noAddresses">
        <select id="address" formControlName="address">
          <option value="" disabled>Seleccioná una dirección</option>
          <option *ngFor="let a of addresses" [value]="a.id">
            {{ a.nickname }} - {{ a.address }}
          </option>
        </select>
      </ng-container>

      <ng-template #noAddresses>
        <p>Usted no ha cargado direcciones aún.</p>
      </ng-template>
    </div>

    <p class="hint">
      Al continuar vas a ser redirigido a Mercado Pago. Cuando termine el proceso,
      el estado real se confirma en nuestro sistema automáticamente.
    </p>

    <button
      type="submit"
      class="btn-mp"
      [disabled]="shippingForm.invalid || addresses.length === 0"
    >
      Pagar con Mercado Pago
    </button>

    <button type="button" class="cancel_btn" (click)="goBack()">
      Volver
    </button>
  </form>
</div>
